<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no">
    <meta name="format-detection"  content="telephone=no"> 
    <meta  http-equiv="x-rim-auto-match" content="none">
    <title>判断手机是否安装微信</title>
</head>
<body>
<a href="javascript:testApp('weixin://')" class="dl-btn" id="download">打开微信</a><br/>
<a href="tel:13764567708">移动WEB页面JS一键拨打号码咨询功能</a><br/>
<a href="sms:13764567708">移动WEB页面JS一键发送短信咨询功能</a><br/>
<a href="wtai://wp//mc;13764567708">拨打10086 </a>  <a href="wtai://wp/ap;13764567708;">将10086存储至电话簿 </a><br/>
<a href="javascript:testApp('skype:+8613240020366?call')">呼叫skype</a>
<script>        
    function testApp(url) {
        var timeout, t = 1000, hasApp = true;
        setTimeout(function () {
            if (!hasApp) {
                //没有安装微信
                var r = confirm("您没有安装skype，请先安装skype!");
                if (r == true) {
                    location.href = "http://skype.gmw.cn/down/down.html"
                }
            } else {
                //安装微信
            }
            document.body.removeChild(ifr);
        }, 2000)

        var t1 = Date.now();
        var ifr = document.createElement("iframe");
        ifr.setAttribute('src', url);
        ifr.setAttribute('style', 'display:none');
        document.body.appendChild(ifr);
        timeout = setTimeout(function () {
            var t2 = Date.now();
            if (!t1 || t2 - t1 < t + 100) {
                hasApp = false;
            }
        }, t);
    }

</script>
<script>
if (navigator.userAgent.match(/(iPhone|iPod|iPad);?/i)) {
    var loadDateTime = new Date();
    window.setTimeout(function () {
            var timeOutDateTime = new Date();
            if (timeOutDateTime - loadDateTime < 5000) {
                window.location = "skype:+8613240020366?call";
                alert(4)
            } else {
                alert(5)
                window.close();
            }
        },
        25);
    window.location = "skype:// ";
} else if (navigator.userAgent.match(/android/i)) {
    var state = null;
    try {
        alert(0)
        state = window.open("skype:// ", '_blank');
    } catch (e) {
        alert(1)
    }
    if (state) {
        alert(2)
        window.close();
    } else {
        alert(3)
        //window.location = "skype:+8613240020366?call";
    }
}

</script>

</body>
</html>
